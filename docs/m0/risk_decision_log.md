# 风险与决策日志（阶段 M0）

## 下一阶段行动清单（可直接勾选）

- [ ] 初始化 Django 项目骨架，接入 DRF 与配置管理基础模型。（意见：同意，按计划执行）
- [ ] 对接 Redis Broker，完成 Celery 任务队列与状态回传雏形。（意见：同意）
- [ ] 抽象首个协议 Worker（建议从 ModbusTCP 入手）并跑通端到端流程。（意见：同意）
- [ ] 设计 Excel → 配置库的校验规则与差异比对方案。（意见：加强校验机制即可）
- [ ] 与前端同步 SPA 技术栈与低保真原型，确认接口契约。（意见：同意）

> 备注区：暂无补充。

## 风险清单

| 编号 | 风险描述                               | 影响               | 可能性 | 缓解措施                                                  | 责任人 | 我的意见 |
| ---- | -------------------------------------- | ------------------ | ------ | --------------------------------------------------------- | ------ | -------- |
| R1   | Excel 导入缺乏严格校验导致错误配置上线 | 任务失败、数据污染 | 高     | 构建多层校验（语法+语义），引入审批流程；上线前在沙箱回放 | 待指定 | 增加校验机制即可 |
| R2   | Redis 单点故障导致任务调度中断         | 采集停摆、状态丢失 | 中     | 部署哨兵/集群，关键任务配置重试；提供降级脚本             | 待指定 | 同意 |
| R3   | Worker 进程崩溃未被及时拉起            | 采集中断、数据缺口 | 中     | 引入心跳监控与自动重启策略；Prometheus 告警               | 待指定 | 同意 |
| R4   | 缺乏鉴权，接口暴露风险                 | 安全审计不过       | 低     | 内网部署；阶段内记录访问日志，预留鉴权中间件              | 待指定 | 同意 |
| R5   | InfluxDB 容量/性能无法满足增长         | 数据丢失或查询缓慢 | 中     | 定义保留策略、冷热数据分层；评估集群化或替换              | 待指定 | 同意 |
| R6   | 前后端协作不同步导致交付延期           | 里程碑延误         | 中     | 每周同步、维护任务看板、定义 API Mock                     | 待指定 | 同意 |

## 待用户决策项（请填写意见）

| 编号 | 事项                  | 当前建议                            | 是否待决策 | 我的意见 |
| ---- | --------------------- | ----------------------------------- | ---------- | -------- |
| D1   | 消息队列选型          | 使用 Redis（阶段内不引入 RabbitMQ） | 否         | 同意 |
| D2   | 鉴权策略              | 暂不启用，保留后续 JWT/SSO 接入点   | 否         | 同意 |
| D3   | 部署模式              | 生产使用 Docker，开发可跑在物理机   | 否         | 同意 |
| D4   | 旧 Flask API 处理方式 | 从新控制平面中剔除，仅保留必要脚本  | 否         | 全部移除旧 Flask API |
| D5   | 外部告警平台接入      | 阶段内不接入，下阶段视需求评估      | 是         | 待确认 |

> 如有新增待决策项，可在此表格继续补充。

## 决策记录

| 编号 | 决策内容                 | 背景                   | 日期       | 状态       | 我的备注             |
| ---- | ------------------------ | ---------------------- | ---------- | ---------- | -------------------- |
| D1   | 消息队列选型 → Redis    | 现有资源可用，部署简单 | 2025-10-05 | 【已确认】 | 内网部署 Redis       |
| D2   | 鉴权策略 → 暂不启用     | 内网环境，团队规模小   | 2025-10-05 | 【已确认】 | 预留接口即可         |
| D3   | 部署模式 → Docker 为主  | 便于标准化与迁移       | 2025-10-05 | 【已确认】 | 开发环境运行物理机   |
| D4   | 旧 Flask API → 不再并行 | 避免双维护             | 2025-10-05 | 【已确认】 | 彻底移除旧 Flask API |
| D5   | 外部告警 → 暂不接入     | 当前业务无需求         | 待定       | 【待确认】 | 等待后续需求确认     |

> 决策通过后，请记录日期与结论，便于进入阶段 M1。
